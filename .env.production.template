# SARA Production Environment Configuration
# Copy to .env.production and fill in all required values
# NEVER commit .env.production to version control

# ==============================================================================
# APPLICATION
# ==============================================================================
NODE_ENV=production
PORT=3000
LOG_LEVEL=info

# ==============================================================================
# DATABASE (PostgreSQL)
# ==============================================================================
# Connection string format: postgresql://[user]:[password]@[host]:[port]/[database]
# For Railway: Use Railway postgres service connection string
DATABASE_URL=postgresql://user:password@host:5432/sara_db

# ==============================================================================
# REDIS (Cache & Message Queue)
# ==============================================================================
# Connection string format: redis://[:password@]host:port
# For Railway: Use Railway redis service connection string
REDIS_URL=redis://host:6379

# ==============================================================================
# OPENAI API
# ==============================================================================
# Get from: https://platform.openai.com/api-keys
# Required: Used for message interpretation and response generation
OPENAI_API_KEY=sk-proj-xxxxxxxxxxxxxxxxxxxxxxxxxxxx

# ==============================================================================
# WHATSAPP BUSINESS API
# ==============================================================================
# Get from: Meta Business Manager > WhatsApp > Configuration

# Phone ID for sending messages (your WhatsApp phone number ID)
WHATSAPP_PHONE_ID=123456789012345

# Business Account ID
WHATSAPP_BUSINESS_ACCOUNT_ID=123456789012345

# App ID (Meta app ID)
WHATSAPP_APP_ID=123456789012345

# App Secret (CONFIDENTIAL - use Railway secrets)
WHATSAPP_APP_SECRET=xxxxxxxxxxxxxxxxxxxxxxxxxxxx

# Verification token (arbitrary string, used for webhook validation)
WHATSAPP_VERIFY_TOKEN=your_secure_verification_token_here

# Access token (from Meta)
WHATSAPP_ACCESS_TOKEN=EAAxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# Template name (initial template to send on abandonment)
WHATSAPP_TEMPLATE_INITIAL=boas_vindas_rcc_comandor

# ==============================================================================
# SARA CONFIGURATION (Optional - defaults provided)
# ==============================================================================

# Maximum conversation cycles before closing
SARA_MAX_CYCLES=5

# Maximum messages to retrieve in conversation history
SARA_MESSAGE_HISTORY_LIMIT=20

# System prompt cache TTL in milliseconds (1 hour default)
SARA_SYSTEM_PROMPT_CACHE_TTL_MS=3600000

# OpenAI API retry attempts
SARA_OPENAI_RETRY_MAX_ATTEMPTS=3

# Initial retry delay in milliseconds
SARA_OPENAI_RETRY_INITIAL_DELAY_MS=1000

# Webhook rate limit window (15 minutes)
SARA_WEBHOOK_RATE_LIMIT_WINDOW_MS=900000

# Maximum requests per window per phone number
SARA_WEBHOOK_RATE_LIMIT_MAX_REQUESTS=10

# ==============================================================================
# NOTES
# ==============================================================================

# 1. DATABASE_URL
#    - For Supabase: Copy from Supabase dashboard
#    - For Railway: Use Railway's auto-generated connection string
#    - For local: postgresql://postgres:password@localhost:5432/sara_db

# 2. REDIS_URL
#    - For Redis Cloud: Get from RedisLabs dashboard
#    - For Railway: Use Railway's auto-generated connection string
#    - For local: redis://localhost:6379

# 3. WHATSAPP Credentials
#    - Get from Meta Business Manager
#    - Do NOT commit to version control
#    - Use Railway Secrets for sensitive values

# 4. OPENAI_API_KEY
#    - Get from OpenAI dashboard
#    - Should have sufficient credits
#    - Use Railway Secrets for sensitive values

# 5. Secrets Management
#    - In Railway: Use "Variables" tab for public values
#    - In Railway: Use "Secrets" tab for sensitive values (API keys, tokens)
#    - Secrets are not exposed in logs or environment

# 6. Verification
#    After setting all variables:
#    1. Test database connection: npm run test:db
#    2. Test Redis connection: npm run test:redis
#    3. Test OpenAI API: npm run test:openai
#    4. Run migrations: npm run migrate
#    5. Start server: npm start
